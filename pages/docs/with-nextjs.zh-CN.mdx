import { Callout } from 'nextra-theme-docs'

# ä¸Next.jsä¸€èµ·ä½¿ç”¨ 

## åº”ç”¨ç¨‹åºè·¯ç”±å™¨ [#app-dir]

### æœåŠ¡å™¨ç»„ä»¶ [#rsc]


<Callout type="default" emoji="âœ…">
  åœ¨Next.js App Routerä¸­ï¼Œé»˜è®¤æƒ…å†µä¸‹ï¼Œæ‰€æœ‰ç»„ä»¶éƒ½æ˜¯React Serverç»„ä»¶ï¼ˆRSCï¼‰ã€‚**æ‚¨åªèƒ½ä»RSCä¸­çš„SWRå¯¼å…¥å¯†é’¥åºåˆ—åŒ–API**
</Callout>

```tsx filename="app/page.tsx" copy
import { unstable_serialize } from 'swr' // âœ… Available in server components
import { unstable_serialize as infinite_unstable_serialize } from 'swr/infinite' // âœ… Available in server components
```

<Callout type="error">
   æ‚¨æ— æ³•ä»SWRå¯¼å…¥ä»»ä½•å…¶ä»–APIï¼Œå› ä¸ºå®ƒä»¬åœ¨RSCä¸­ä¸å¯ç”¨ã€‚
</Callout>

```tsx filename="app/page.tsx" highlight={1}
import useSWR from 'swr' // âŒ This is not available in server components
```

### å®¢æˆ·ç«¯ç»„ä»¶

æ‚¨å¯ä»¥ä½¿ç”¨'ä½¿ç”¨å®¢æˆ·ç«¯'æŒ‡ä»¤æ ‡è®°ç»„ä»¶ï¼Œæˆ–ä»å®¢æˆ·ç«¯ç»„ä»¶å¯¼å…¥SWRï¼Œè¿™ä¸¤ç§æ–¹å¼éƒ½å…è®¸æ‚¨ä½¿ç”¨SWRå®¢æˆ·ç«¯æ•°æ®è·å–é’©å­ã€‚

```tsx filename="app/page.tsx" highlight={1} copy
'use client'
import useSWR from 'swr'
export default Page() {
  const { data } = useSWR('/api/user', fetcher)
  return <h1>{data.name}</h1>
}
```

å¦‚æœæ‚¨éœ€è¦ä½¿ç”¨â€œSWRConfigâ€åœ¨æœåŠ¡å™¨ç»„ä»¶'å¸ƒå±€'æˆ–'é¡µé¢'ä¸­é…ç½®å…¨å±€è®¾ç½®ï¼Œè¯·åˆ›å»ºä¸€ä¸ªå•ç‹¬çš„æä¾›å•†å®¢æˆ·ç«¯ç»„ä»¶æ¥è®¾ç½®æä¾›å•†å’Œé…ç½®ï¼Œç„¶ååœ¨æœåŠ¡å™¨ç»„ä»¶é¡µé¢ä¸­ä½¿ç”¨å®ƒã€‚

```tsx filename="app/swr-provider.tsx" copy
'use client';
import { SWRConfig } from 'swr'
export const SWRProvider = ({ children }) => {
  return <SWRConfig>{children}</SWRConfig>
};
```

```tsx filename="app/page.tsx" copy
// This is still a server component
import { SWRProvider } from './swr-provider'
export default Page() {
  return (
    <SWRProvider>
      <h1>hello SWR</h1>
    </SWRProvider>
  )
}
```


## å®¢æˆ·ç«¯æ•°æ®å–å–[#å®¢æˆ·ç«¯æ•°æ®å–] 

å¦‚æœæ‚¨çš„é¡µé¢åŒ…å«é¢‘ç¹æ›´æ–°çš„æ•°æ®ï¼Œå¹¶ä¸”æ‚¨ä¸éœ€è¦é¢„æ¸²æŸ“æ•°æ®ï¼Œé‚£ä¹ˆSWRéå¸¸é€‚åˆï¼Œä¸éœ€è¦ç‰¹æ®Šè®¾ç½®ï¼šåªéœ€å¯¼å…¥`useSWR`å¹¶ä½¿ç”¨ä»»ä½•ä½¿ç”¨æ•°æ®çš„ç»„ä»¶å†…çš„é’©å­å³å¯ã€‚ 
 
ä»¥ä¸‹æ˜¯å®ƒçš„å·¥ä½œåŸç†ï¼š 
 
-é¦–å…ˆï¼Œç«‹å³æ˜¾ç¤ºæ²¡æœ‰æ•°æ®çš„é¡µé¢ã€‚ æ‚¨å¯ä»¥æ˜¾ç¤ºä¸¢å¤±æ•°æ®çš„åŠ è½½çŠ¶æ€ã€‚ 
- ç„¶åï¼Œåœ¨å®¢æˆ·ç«¯è·å–æ•°æ®ï¼Œå‡†å¤‡å¥½åæ˜¾ç¤ºã€‚ 

ä¾‹å¦‚ï¼Œè¿™ç§æ–¹æ³•é€‚ç”¨äºç”¨æˆ·ä»ªè¡¨æ¿é¡µé¢ã€‚ ç”±äºä»ªè¡¨æ¿æ˜¯ä¸€ä¸ªç§äººçš„ã€ç‰¹å®šäºç”¨æˆ·çš„é¡µé¢ï¼ŒSEOæ— å…³ç´§è¦ï¼Œé¡µé¢ä¸éœ€è¦é¢„æ¸²æŸ“ã€‚ æ•°æ®ç»å¸¸æ›´æ–°ï¼Œè¿™éœ€è¦åœ¨è¯·æ±‚æ—¶è·å–æ•°æ®ã€‚ 

## é»˜è®¤æ•°æ®é¢„æ¸²æŸ“[#é»˜è®¤æ•°æ®é¢„æ¸²æŸ“] 
 
å¦‚æœé¡µé¢å¿…é¡»é¢„æ¸²æŸ“ï¼ŒNext.jsæ”¯æŒ[2ç§é¢„æ¸²æŸ“å½¢å¼]ï¼ˆhttps://nextjs.org/docs/basic-features/data-fetchingï¼‰ï¼š 
**é™æ€ç”Ÿæˆï¼ˆSSGï¼‰**å’Œ**æœåŠ¡å™¨ç«¯æ¸²æŸ“ï¼ˆSSRï¼‰**ã€‚ 
 
ä¸SWRä¸€èµ·ï¼Œæ‚¨å¯ä»¥ä¸ºSEOé¢„æ¸²æŸ“é¡µé¢ï¼Œè¿˜å…·æœ‰è¯¸å¦‚å½’ç§ã€é‡æ–°validationã€ç„¦ç‚¹è·Ÿè¸ªã€å®¢æˆ·ç«¯é—´éš”é‡æ–°è·å–ç­‰åŠŸèƒ½ã€‚ 
 
æ‚¨å¯ä»¥ä½¿ç”¨[`SWRConfig`](/docs/global-configuration)çš„`fallback`é€‰é¡¹å°†é¢„è·å–çš„æ•°æ®ä½œä¸ºæ‰€æœ‰SWRé’©å­çš„åˆå§‹å€¼ä¼ é€’ã€‚ 
 
ä¾‹å¦‚`getStaticProps`ï¼š

```jsx
 export async function getStaticProps () {
  // `getStaticProps` is executed on the server side.
  const article = await getArticleFromAPI()
  return {
    props: {
      fallback: {
        '/api/article': article
      }
    }
  }
}

function Article() {
  // `data` will always be available as it's in `fallback`.
  const { data } = useSWR('/api/article', fetcher)
  return <h1>{data.title}</h1>
}

export default function Page({ fallback }) {
  // SWR hooks inside the `SWRConfig` boundary will use those values.
  return (
    <SWRConfig value={{ fallback }}>
      <Article />
    </SWRConfig>
  )
}
```

è¯¥é¡µé¢ä»å¤„äºé¢„æ¸²æŸ“ä¸­ã€‚ å®ƒå¯¹SEOå‹å¥½ï¼Œå“åº”è¿…é€Ÿï¼Œä½†ä¹Ÿå®Œå…¨ç”±å®¢æˆ·ç«¯çš„SWRæä¾›æ”¯æŒã€‚ æ•°æ®å¯ä»¥éšç€æ—¶é—´çš„æ¨ç§»è¿›è¡ŒåŠ¨æ€å’Œè‡ªæˆ‘æ›´æ–°ã€‚

<Callout emoji="ğŸ’¡">
  `æ–‡ç« `ç»„ä»¶å°†é¦–å…ˆå‘ˆç°é¢„ç”Ÿæˆçš„æ•°æ®ï¼Œåœ¨é¡µé¢æ°´åˆåï¼Œå®ƒå°†å†æ¬¡è·å–æœ€æ–°æ•°æ®ä»¥ä¿æŒåˆ·æ–°ã€‚
</Callout>

### å¤æ‚é”® [#complex-keys]

`useSWR`å¯ä»¥ä¸`array`å’Œ`function`ç±»å‹çš„é”®ä¸€èµ·ä½¿ç”¨ã€‚ä½¿ç”¨æ­¤ç±»å¯†é’¥ä½¿ç”¨é¢„è·å–æ•°æ®éœ€è¦ä½¿ç”¨`unstable_serialize`å¯¹`fallback`å¯†é’¥è¿›è¡Œåºåˆ—åŒ–ã€‚

```jsx
import useSWR, { unstable_serialize } from 'swr'

export async function getStaticProps () {
  const article = await getArticleFromAPI(1)
  return {
    props: {
      fallback: {
        // unstable_serialize() array style key
        [unstable_serialize(['api', 'article', 1])]: article,
      }
    }
  }
}

function Article() {
  // using an array style key.
  const { data } = useSWR(['api', 'article', 1], fetcher)
  return <h1>{data.title}</h1>
}

export default function Page({ fallback }) {
  return (
    <SWRConfig value={{ fallback }}>
      <Article />
    </SWRConfig>
  )
}
```
